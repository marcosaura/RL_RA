[2024-05-26 23:10:27,345][train][INFO][main.py><module>] ==> Path: /home/marcos/Desktop/Atari_100k/EfficientZero_RA_16/EfficientZero_RA_16/results/atari/none/BoxingNoFrameskip-v4/seed=0/Sun May 26 23:10:27 2024
[2024-05-26 23:10:27,345][train][INFO][main.py><module>] ==> Param: {'action_space_size': 18, 'num_actors': 1, 'do_consistency': True, 'use_value_prefix': True, 'off_correction': True, 'gray_scale': False, 'auto_td_steps_ratio': 0.3, 'episode_life': True, 'change_temperature': True, 'init_zero': True, 'state_norm': False, 'clip_reward': True, 'random_start': True, 'cvt_string': True, 'image_based': True, 'max_moves': 3000, 'test_max_moves': 3000, 'history_length': 400, 'num_simulations': 50, 'discount': 0.988053892081, 'max_grad_norm': 5, 'test_interval': 10000, 'test_episodes': 32, 'value_delta_max': 0.01, 'root_dirichlet_alpha': 0.3, 'root_exploration_fraction': 0.25, 'pb_c_base': 19652, 'pb_c_init': 1.25, 'training_steps': 100000, 'last_steps': 20000, 'checkpoint_interval': 100, 'target_model_interval': 200, 'save_ckpt_interval': 10000, 'log_interval': 1000, 'vis_interval': 1000, 'start_transitions': 2000, 'total_transitions': 100000, 'transition_num': 1, 'batch_size': 256, 'num_unroll_steps': 5, 'td_steps': 5, 'frame_skip': 4, 'stacked_observations': 4, 'lstm_hidden_size': 512, 'lstm_horizon_len': 5, 'reward_loss_coeff': 1, 'value_loss_coeff': 0.25, 'policy_loss_coeff': 1, 'consistency_coeff': 2, 'device': 'cuda', 'debug': False, 'seed': 0, 'value_support': <core.config.DiscreteSupport object at 0x7fee9c30a1a0>, 'reward_support': <core.config.DiscreteSupport object at 0x7fee9c30a2f0>, 'weight_decay': 0.0001, 'momentum': 0.9, 'lr_warm_up': 0.01, 'lr_warm_step': 1000, 'lr_init': 0.2, 'lr_decay_rate': 0.1, 'lr_decay_steps': 100000, 'mini_infer_size': 64, 'priority_prob_alpha': 0.6, 'priority_prob_beta': 0.4, 'prioritized_replay_eps': 1e-06, 'image_channel': 3, 'proj_hid': 1024, 'proj_out': 1024, 'pred_hid': 512, 'pred_out': 1024, 'bn_mt': 0.1, 'blocks': 1, 'channels': 64, 'reduced_channels_reward': 16, 'reduced_channels_value': 16, 'reduced_channels_policy': 16, 'resnet_fc_reward_layers': [32], 'resnet_fc_value_layers': [32], 'resnet_fc_policy_layers': [32], 'downsample': True, 'env_name': 'BoxingNoFrameskip-v4', 'obs_shape': (12, 96, 96), 'case': 'atari', 'amp_type': 'torch_amp', 'use_priority': True, 'use_max_priority': True, 'cpu_actor': 5, 'gpu_actor': 5, 'p_mcts_num': 1, 'use_root_value': False, 'auto_td_steps': 30000.0, 'use_augmentation': True, 'augmentation': ['shift', 'intensity'], 'revisit_policy_search_rate': 0.99, 'model_dir': '/home/marcos/Desktop/Atari_100k/EfficientZero_RA_16/EfficientZero_RA_16/results/atari/none/BoxingNoFrameskip-v4/seed=0/Sun May 26 23:10:27 2024/model'}
[2024-05-26 23:10:27,389][root][ERROR][main.py><module>] ==> empty(): argument 'size' failed to unpack the object at pos 2 with error "type must be tuple of ints,but got float"
Traceback (most recent call last):
  File "/home/marcos/Desktop/Atari_100k/EfficientZero_RA_16/EfficientZero_RA_16/main.py", line 98, in <module>
    model, weights = train(game_config, summary_writer, model_path)
  File "/home/marcos/Desktop/Atari_100k/EfficientZero_RA_16/EfficientZero_RA_16/core/train.py", line 436, in train
    model = config.get_uniform_network()
  File "/home/marcos/Desktop/Atari_100k/EfficientZero_RA_16/EfficientZero_RA_16/config/atari/__init__.py", line 108, in get_uniform_network
    return EfficientZeroNet(
  File "/home/marcos/Desktop/Atari_100k/EfficientZero_RA_16/EfficientZero_RA_16/config/atari/model.py", line 643, in __init__
    self.prediction_network = PredictionNetwork(
  File "/home/marcos/Desktop/Atari_100k/EfficientZero_RA_16/EfficientZero_RA_16/config/atari/model.py", line 428, in __init__
    self.RA_layer = nn.Sequential(RingAttractorLayer((action_space_size/2)*8,action_space_size,action_space_size,0.1))
  File "/home/marcos/Desktop/Atari_100k/EfficientZero_RA_16/EfficientZero_RA_16/config/atari/model.py", line 14, in __init__
    self.rnn = nn.RNN(input_size, output_size, bias=False, batch_first=True)
  File "/home/marcos/.local/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 489, in __init__
    super().__init__(mode, *args, **kwargs)
  File "/home/marcos/.local/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 114, in __init__
    w_ih = Parameter(torch.empty((gate_size, layer_input_size), **factory_kwargs))
TypeError: empty(): argument 'size' failed to unpack the object at pos 2 with error "type must be tuple of ints,but got float"
